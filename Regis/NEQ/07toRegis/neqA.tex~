
\section{Introduction\hfill{\small\today}}
The paper starts in section~\ref{se:specs} with a sound and complete calculus 
$NEQ$ for the
multialgebraic semantics of nondeterminism (introduced in \cite{Mich}, and whose 
variants were studied in 
\cite{WM}, \cite{Top}). Using techniques of \cite{K}, \cite{Aida1}, \cite{Aida2},
and their refinements and modifications, the paper presents a series
of transformations, sections~\ref{se:inter}-\ref{se:lastNEQ}, leading
to an equivalent calculus without the general ($cut$) rule. The
specific (non-logical) axioms and the general cut-rule are replaced by 
the {\em specific-cut}
rules in section~\ref{sub:Spcut}, and several other useful specializations of rules are
introduced. The main cut-elimination is proved in subsection~\ref{sub:cut} and section
\ref{se:lastNEQ} gives the final version of the cut-free calculus $NEQ_5$ with
specific-cut rules replacing specific axioms.
Then section~\ref{se:noax} studies the situation when no specific
axioms are present, showing that in this case no cut or cut-like elimination rules 
are needed,
thus yielding quite a simple calculus for proving multialgebraic tautologies.
Sections~\ref{se:connectives} and \ref{se:related} contain some concluding remarks and
comparison with related works.

The impatient reader, interested only in the main results, may consult directly:\\[1ex]
\begin{tabular}{rlcl}
1. &  figure \ref{fi:neq} on page \pageref{fi:neq} & -- & the original version of
the calculus $NEQ$ \\
2. & figure \ref{fi:neq51} on page \pageref{fi:neq51} & -- & the final cut-free
version $NEQ_5$ \\
% & & & specific axioms are dealt with by means of  \\
 & & & with the specific-cut rules \\
3. & proposition~\ref{le:elcut}, page \pageref{le:elcut} 
       & -- & the main cut-elimination result \\
   & lemma \ref{le:nott}, \ref{le:noxx}, page \pageref{le:nott}, \pageref{le:noxx} 
       & -- & elimination of auxiliary cut-rules \\
4. & figure \ref{fi:neq6} on page \pageref{fi:neq6} & -- & the final calculus
without specific axioms $NEQ_6$ \\ 
 & & & not containing cut, specific cut or elimination rules \\
5. & section \ref{se:connectives} & -- & final comments
\end{tabular}

\section{Specifications of nondeterministic operations}\label{se:specs}

\begin{DEFINITION} {\bf (Specifications)} \label{de:terms-vars-forms}
A specification SP is a pair ($\Sigma,\Ax$), where $\Sigma$ is a signature, i.e.
a pair ($\Sorts,\Funcs$) of sort and operation symbols (the latter with specified
arities and rank). $\Ax$ is a a set of sequents, $\Gamma\Seq\Delta$, 
where $\Gamma, \Delta$ are finite sets of atomic formulae.

%There is a countable set of variables \C V.
The set of terms\footnote{We will not mention sorting explicitly
and always assume that terms and formulae are correctly sorted.}
 built in the standard way from the variables and
operation symbols is denoted $\Terms{\Funcs,\C V}$. An {\em atomic formula} 
is an {\em equality}, $s=t$, or an {\em inclusion}, $s\Incl t$, of terms
$s,t\in\Terms{\Funcs,\Vars}$ (where $t$ is called the 
right-hand-side (RHS) and $s$ the left-hand-side (LHS) of inclusion).
\end{DEFINITION}
\noindent
We will write $\C V(\sigma)$ to denote the variables occurring in $\sigma$ 
(which may be any syntactic entity or a set thereof), and $x\in\Vars$ to say that
$x$ is a variable.

The non-standard aspect of this definition concerns the atomic formulae which are
inclusions (typically, one has only equalities). This originates from the fact that
the structures to be specified are not standard algebras but {\em multialgebras},
where operations may return {\em sets} of individuals rather than only individuals.
%
\begin{DEFINITION} {\bf (Multialgebras)} \label{de:multialgebras}
Given a signature $\Sigma=(\Sorts,\Funcs)$, a {\em $\Sigma$-multialgebra} $A$
is given by:
\begin{itemize}\MyLPar
\item  the carrier $|A|$ of $A$ consists of a set $S^A$ for each $S\in\Sorts$
\item for each operation symbol $f: \List Sn\times \rightarrow S$, an operation
$f^A: \List {S^A}n\times \rightarrow \C P^+(S^A)$, where $\C P^+(X)$ denotes the 
power set of the set $X$ with empty set excluded.
\end{itemize}
\end{DEFINITION}
\noindent
Given a multialgebra $A$ and an assignment to variables $\beta:X\rightarrow |A|$, 
there is a unique function $\beta [\_]$ which gives, to each term $t$ 
with $\C V(t)\subseteq X$, its interpretation in $A$ defined in the usual way as:
\[ \begin{array}{ccccc} 
\beta [x] = \beta (x) & & \beta [c] = c^A
& & \beta [f(\List tn,)] = f^A(\beta[t_1]\ldots \beta[t_n]) 
\end{array} \]
Unlike in classical algebra, this function need not be a homomorphism of multialgebras.
An extensive study of multialgebras can be found in \cite{WB}.
%
\begin{DEFINITION} {\bf (Semantics)} \label{de:semantics}
A $\Sigma$-multialgebra $A$ satisifes an atomic formula $\phi$ under assignment
 $\beta:X\rightarrow |A|$, written $A,\beta\models \phi$, iff:
\begin{itemize}\MyLPar
\item $\phi$ is $s=t$, and $\beta[s]=\beta[t]=\{a\}$ for some $a\in |A|$
\item $\phi$ is $s\Incl t$, and $\beta[s]\subseteq\beta[t]$.
\end{itemize}
 $A$ satisifes a sequent, $A\models\Gamma\Seq\Delta$ iff,
for each assignment $\beta$, there exists a $\gamma\in\Gamma : A,\beta\not\models
\gamma$, or there exists a $\delta\in\Delta: A,\beta\models \delta$. 
%satisfies at least one of the atoms in $\Delta$ or $A$ does not satisfy at least
%one of the atoms in $\Gamma$.
A $\Sigma$-multialgebra $A$ is an SP{\em-multimodel}, $A\in \MMod(SP)$, iff it satisfies 
all axioms $\Ax$ of SP.
\end{DEFINITION}
\noindent
The natural deduction-like calculus $NEQ$ consists of the rules given in
figure \ref{fi:neq} \cite{WM}. Each specification contains a set
$\Ax$ of {\em specific axioms} \reff{ru:spax}.
\begin{figure}[hbt]
\hspace*{3em}\begin{tabular}{|ll|}
\hline
\multicolumn{2}{|c|}{{\bf Axioms} :}\\[.5ex]
\TABRUL{\Seq x=x : x\in\Vars} \label{ru:neqx} & 
\TABRUL{s\odot t \Seq s\odot t} \label{ru:neqid}\ \ \ \ $\odot\in\{=,\Incl\}$  \\[2ex]
%%& {\footnotesize \ \ \ \ \ \ \ \ \ - $\odot\in\{=,\Incl\}$} \\[2ex]
%
\multicolumn{2}{|c|}{{\bf Identity and inclusion rules} :}\\[.5ex]
\TABRULE{
\Gamma_t^x\Seq\Delta_t^x \ \ ; \ \ \Gamma'\Seq s=t,\Delta'}
{\Gamma_s^x,\Gamma'\Seq\Delta_s^x,\Delta' } \label{ru:neqeq} & 
\TABRULE{
\Gamma\Seq\Delta, w(t)\preceq q \ \ ; \ \ \Gamma'\Seq s\Incl t,\Delta'}
{\Gamma,\Gamma'\Seq\Delta',\Delta, w(s)\preceq q} \label{ru:neqincl} \\[4ex]
%& {\footnotesize \ \ \ - $x$ not  in a RHS of $\Incl$ in $\Delta$.} \\[2ex]
%
\multicolumn{2}{|c|}{{\bf Elimination rules}:}\\[.5ex]
\TABRULE{\Gamma, x\Incl t\Seq\Delta} 
{\Gamma_t^x\Seq\Delta_t^x}\ ($elim1$) \label{ru:elim1} 
& \TABRULE{x\Incl t, y\Incl r(x), \Gamma\Seq\Delta} 
{y\Incl r(t),\Gamma\Seq\Delta}\ ($E_a$)  \label{ru:elim2}  \\
%\noindent
{\footnotesize \ \ \ - $x\not\in \Vars(t)$;} & {\footnotesize \ \ \ -
$x\not\in\Vars(t,y,\Gamma,\Delta), y\in\Vars$}  \\
{\footnotesize \ \ \ - $x$ occurs at most once
in $\Gamma\Seq\Delta$ } & {\footnotesize \ \ \ - $x$ occurs at most once in $r$}  \\
{\footnotesize \ \ \ - and not in a RHS of $\Incl$ in $\Gamma$} &  \\[2ex]
% 
\multicolumn{2}{|c|}{{\bf Weakening rules} ($W$) :}\\[.5ex]
\multicolumn{1}{|r}{\prule{\Gamma\Seq\Delta}{\Gamma\Seq\Delta,\atom}}  & 
\TABRULE{\Gamma\Seq\Delta}{\Gamma, \atom\Seq\Delta}\label{ru:weak}   \\[4ex]
%%
\multicolumn{2}{|c|}{{\bf Cut rule} ($cut$) :}\\[.5ex]
\multicolumn{2}{|c|}{\TABRULE{\Gamma\Seq\Delta,\atom\ \ ;\ \ \atom,\Gamma'\Seq\Delta'}
{\Gamma,\Gamma'\Seq\Delta,\Delta'}\label{ru:neqcut} } \\[2ex] %\hline
\multicolumn{2}{|c|}{{\bf Specific axioms} :}\\[.5ex]
\multicolumn{2}{|c|}{\TABRUL{\lis\atom\Seq \lism\batom{m}}\label{ru:spax}
 ($\Ax_k$)\ \ \ \  where $k$ identifies a particular axiom in the set $\Ax$.}\\[1ex]
\hline
\end{tabular}
\caption{The rules and axioms of $NEQ$}\label{fi:neq}
\end{figure}

\noindent
$\atom$, $\batom$ stand for atoms, i.e., $s\odot t$.
 The symbol $\preceq$ abbreviates either $=$ or $\Incl$. 
$\Gamma_t^x$ indicates replacement of one or more $x$ by $t$.
Sometimes, we may write $\Gamma[x]$, $\phi[x]$ for a (set of) atom(s) containing
$x$, and then $\Gamma[t]$, $\phi[t]$ for the result of replacing these occurrences
of $x$ by $t$.

%
\begin{REMARK} \label{re:1}
{From the definition of a sequent it follows that $NEQ$ implicitly contains the 
structural rules ``exchange'' and ``contraction''.}
$NEQ$ also assumes implicitly symmetry of equations, i.e., $s=t$ is treated as an 
unorded set $\{s,t\}$. 

Two peculiar features of this calculus are the absence of the unrestricted 
substitutivity,
and that $=$ is only a partial equivalence.
  The equality $t=t$ represents ``deterministic equality'' -- it holds only for terms which
denote individual elements of the carrier.
 Thus, in general, $NEQ\ \not\vdash\ \Seq t=t$. 
But since
variables are assigned only individual elements, we do have 
$NEQ\vdash\ \Seq x=x$  for any variable $x$. Consequently, since
terms may denote {\em sets} of individuals, unrestricted substitutivity would not
be sound wrt. the multialgebraic semantics. For motivations and examples the reader
is referred to \cite{WM,Top,Broy}.
\end{REMARK}
%
\begin{THEOREM}\label{th:cmpl} {\em \cite{WM}}
$NEQ$ is sound and complete with respect to the multialgebraic semantics, i.e.,
for any sequent $S$:
\[\MMod(\Sigma,\Ax)\models S \ \ \iff \ \ \der{\Ax, NEQ}{}S\]
\end{THEOREM}
\noindent
 $\der{\Ax,NEQ}{}S$,  indicating that $S$ is derivable from $\Ax$
using the rules of $NEQ$, might be written in a more standard fashion as
 $\Ax\der{}{NEQ}S$. However, we will consider variants of the calculus
 where the axioms $\Ax$ are built into the rules, and the latter notation will be used
 for a different purpose.

%We  assume given a fixed signature and a set $\Ax$ of
%specific axioms of the general form:
%\PROOFRUL{r_i \odot_i s_i \Seq u_j\odot_j v_j}\label{ru:spax}
% ($\Ax_k$)\ \ \ \  where $k$ identifies a particular axiom in the set $\Ax$.
%
\begin{DEFINITION} Let $I, J$ be arbitrary
calculi. We use the following notational convention:
\begin{itemize}\MyLPar
\item $I \Rightarrow J$ if, for any sequent $S : \der{\Ax, I}{}S 
\ \Rightarrow\  \der{\Ax, J}{}S;$
\item $I\equiv J$ if $I\Rightarrow J$ and $J\Rightarrow I$;
\item $I^c$ denotes $I$ extended with the 
($cut$) rule;
\item $\der IDS$ indicates that $D$ is a derivation of $S$ 
using the rules of calculus $I$;
\item for derivations $D, D'$, we write $D\impl D'$ to indicate that $D'$
may be constructed, assuming that $D$ is given.
\item Variable $x$ in the applications of any of the elimination rules will be called
{\em eigen-variable}.
\end{itemize}
\end{DEFINITION}
%
%
\section{Some intermediary calculi}\label{se:inter}
In this section we transform $NEQ$ to an equivalent calculus 
$NEQ_{3}$ which will provide a basis for the final calculus and 
(cut)-elimination.
Instead of introducing the resulting calculus at once, we proceed 
step by step to better visualize the crucial transformations. The most 
significant one occurs in subsection~\ref{sub:Spcut} where specific 
axioms are replaced by appropriate inference rules.

\subsection{Kanger-like calculus -- $NEQ_1$}\label{se:neq1}
We transform $NEQ$ to an equivalent calculus $NEQ_1$ 
with Kanger-like rules for equality \cite{K} and inclusion.

\begin{DEFINITION} \label{de:neq1}
The calculus $NEQ_1$ is obtained from $NEQ$ by the following transformations:\\
\noindent For any $t\in\Terms{\Funcs,\C V}$ and $x\in\Vars$, the following axiom 
is added:
\PROOFRUL{x\Incl t \Seq x\Incl t}\ \label{ru:neq1tint}\\[.5ex]
\noindent The axiom \reff{ru:neqid}, $s\odot t\Seq s\odot t$ is replaced by:
\PROOFRUL{s=t\Seq s=t}\label{ru:neq1id}\\[.5ex]
 % \ \ \ where: $s,t\not\in\C V$\\[4pt]
\noindent The inference rules for equality and inclusion~\reff{ru:neqeq}, 
\reff{ru:neqincl} are replaced by:
\PROOFRULE{s=t,\Gamma_t^x\Seq\Delta_t^x}{s=t,\Gamma_s^x\Seq\Delta_s^x} ($=_1$)
\label{ru:K12} \ \ \ \ \ \ \ \ 
\prule{t=s,\Gamma_t^x\Seq\Delta_t^x}{t=s,\Gamma_s^x\Seq\Delta_s^x} ($=_2$)
\PROOFRULE{\Gamma, s\Incl t\Seq \Delta, w(t)\preceq q}{\Gamma, s\Incl t\Seq
\Delta, w(s)\preceq q} $\iLs$
\label{ru:Kincl}
%\ \ \ \ where: $x$ in $\Delta$ isn't in the RHS of $\Incl$.
\end{DEFINITION}
\noindent
Since the cases for $=_1$ and $=_2$ are entirely symmetric,
% both for  $=_{ia}$ and $=_{is}$, 
in the sequel we'll treat them uniformly and write only $=$.
% $=_s$.

\begin{LEMMA}\label{le:neqtoneq1} $NEQ \Rightarrow NEQ_1$ \end{LEMMA}
\begin{PROOF}
We show that the axioms~\reff{ru:neqid} and inference rules~\reff{ru:neqeq},
\reff{ru:neqincl} are derivable in $NEQ_1$.
%$NEQ_1$ proves all the axioms $S$ and rules $R$ removed from $NEQ$.
\begin{LS}\MyLPar
%%\item Let $S$ be $s=x\Seq s=x$, where $x\in\C V$ (the case
%%$x=s\Seq x=s$ is analogous). \\ We derive it in $NEQ_1$: \ \ \ 
%%\( \begin{array}{cl}
%%  \Seq x=x & \raisebox{-1.2ex}[1.5ex][0ex]{(W)} \\ \cline{1-1}
%%  s=x\Seq x=x & \raisebox{-1.2ex}[1.5ex][0ex]{($=$)} \\ \cline{1-1}
%%  s=x\Seq s=x
%%\end{array} \) 
\item Let $S$ be $s\Incl t\Seq s\Incl t$. The derivation in $NEQ_1$
is obtained by choosing a fresh variable $x$:\ \ \ 
\[\prar{
  x\Incl t\Seq x\Incl t \cl
  \Seq t\Incl t & \rabove{(elim1)}   \cl
  s\Incl t\Seq t\Incl t & \rabove{(W)}  \cl
  s\Incl t\Seq s\Incl t & \rabove{\iLs}
}
\]
\item Suppose that $NEQ_1$ proves the premises of \reff{ru:neqeq}. Weakening the
first premise with the formula $s=t$ allows us to get $s=t,\Gamma_s^x\Seq\Delta_s^x$ by
($=$) and ($cut$) with the second premise yields the conclusion of 
\reff{ru:neqeq} in $NEQ_1$:
\begin{center} \( \begin{array}{ccl}
 & \Gamma_t^x\Seq\Delta_t^x & \raisebox{-1.2ex}[1.5ex][0ex]{(W)} \\ \cline{2-2}
 & s=t,\Gamma_t^x\Seq\Delta_t^x & \raisebox{-1.2ex}[1.5ex][0ex]{($=$)} 
      \\ \cline{2-2}
\Gamma'\Seq s=t,\Delta' & s=t,\Gamma_s^x\Seq\Delta_s^x 
   & \raisebox{-1.2ex}[1.5ex][0ex]{($cut$)} \\ \cline{1-2}
\multicolumn{2}{c}{\Gamma_s^x,\Gamma'\Seq\Delta_s^x,\Delta'}
\end{array} \) \end{center}
\item An analogous procedure as above allows us to derive \reff{ru:neqincl} in $NEQ_1$
\end{LS}
\end{PROOF}

\begin{LEMMA}\label{neq1toneq} $NEQ_1 \Rightarrow NEQ$ \end{LEMMA}
\begin{PROOF}
\begin{LS}\MyLPar
%% \item The axiom \reff{ru:neq1tint} is $NEQ$ derivable by ($elim1$):
%%\prule{x\Incl t\Seq x\Incl t}{\Seq t\Incl t}
\item 
Both inference rules \reff{ru:K12} are derived by a 
single application of \reff{ru:neqeq}:

\prule{s=t,\Gamma_t^x\Seq\Delta_t^x\ \ ;\ \ s=t\Seq s=t}
      {s=t,\Gamma_s^x\Seq\Delta_s^x}
\item 
and the rule \reff{ru:Kincl} is obtained by an analogous application 
of \reff{ru:neqincl}.
\end{LS}
\end{PROOF}
The two lemmas yield:
\begin{CLAIM}\label{le:neqisneq1} $NEQ\equiv NEQ_1$.\end{CLAIM}

\subsection{$NEQ_2$ -- some restrictions on ($cut$) and 
($elim1$).}\label{sub:Spcut}
A new equivalent of $NEQ$ is introduced in which the general ($cut$) rule is
replaced by the {\em specific-cut rules} depending on the specific axioms
of the specification. Recall that we have fixed a set of axioms $\Ax$, of the 
general form \reff{ru:spax}: \(r_i \odot_i s_i \Seq u_j\odot_j v_j\).

\begin{DEFINITION} Calculus $NEQ_2$ is obtained from $NEQ_1$ by:
\begin{itemize}\MyLPar
\item[1.] replacing the inference rule \reff{ru:elim1} with:
\PROOFRULE{\Gamma,x\Incl t\Seq\Delta}{\Gamma\Seq\Delta_t^x}\ \ 
 ($E_s$)\ \ 
 $x\not\in\Vars(\Gamma,t)$ and at most one occurence of $x$ in
$\Delta$.
\item[2.]  adding the following inference rules for inclusion:
\PROOFRULE{s\Incl t,w(s)\preceq q, \GSD}{s\Incl t,w(t)\preceq q,\GSD}
 \label{ru:Kincla} $\iLa$  \ \ \ \ \ \ \ \ 
\prule{s\Incl t, \GSD, w\Incl q(s)}{s\Incl t, \GSD, w\Incl q(t)} $\iRs$ \\
(In the case of equality $w(s)=q$, we implicitly allow $q=w(t)$ in the conclusion.)
\item[3.] removing the cut-rule \reff{ru:neqcut};
\item[4.] replacing each specific axiom $\Ax_k$ of the form \reff{ru:spax} by 
the ($Sp.cut_k$) rule:
\PROOFRULE{\GSD,A_1\ ;\ ...\ ;\ \GSD,A_n\ ;\ B_1,\GSD\ ;\ ...\ ;\ B_m,\GSD
%\Gamma\Seq\Delta,A_1;\ \ ;\ \ u_j\odot_j v_j,\Gamma\Seq\Delta
} {\Gamma\Seq\Delta}
 \label{ru:spcut} ($Sp.cut_k$)
\end{itemize}
Formulae $\atom_i$ and $\batom_j$ in applications of ($Sp.cut$) will be 
called the {\em specific cut formulae}.
\end{DEFINITION} 
Before proving the equivalence of $NEQ_1$ and $NEQ_2^c$ we introduce the
following conventions to be used extensively.

\begin{DEFINITION} In an application of a rule we distinguish the following
formulae:
\begin{itemize}\MyLPar
\item {\em active} -- the atomic formula explicitly mentioned in the premise(s)
and conclusion of the rule but not modified by its application;
\item {\em side} -- the formulae in the premise of the rule which are modified
(or removed) by its application;
\item {\em modified} -- the new formulae obtained in the conclusion of the rule
(either as the modified side formulae or as a new formulae introduced in the 
conclusion).\footnote{This is also called {\em principal}.}
\end{itemize}
\end{DEFINITION}
\noindent
The term which appears in a modified formula as a 
result of the application of the rule is called the {\em resulting
term}. Sometimes we will refer by ``modified'' to the term from the side
formula which was changed by the application of the rule, by 
``replaced'' to this part of it which was replaced and by ``substituted'' 
to this part of the resulting term which appeard for the replaced 
(sub)term of the modified term.

It is implicitly assumed that each rule modifies at most one term, even if
their formulation might indicate that several terms are modified
simultaneously (like for instance \reff{ru:neqeq} and \reff{ru:neqincl} in figure \ref{fi:neq}). This
convention is used throughout the whole paper.
\begin{EXAMPLE}
For instance, each of the weakening rules \reff{ru:weak}
has only one modified formula ($s\odot t$), and no side formula.
The ($cut$) rule \reff{ru:neqcut} has only side formula which is
also called the {\em cut} formula. The atom $s\odot t$ in the rules \reff{ru:K12}, 
\reff{ru:Kincl} is the active formula of these rules. 
Term $t$ is modified and $s$ substituted in
\reff{ru:K12} and in \reff{ru:Kincl}. The number of modified and side formulae in
these rules depends on the number of atoms in which $t$ is replaced by $s$. 
In the following application of ($elim1$) rule \reff{ru:elim1}
\begin{center}
\prule{\Gamma, \phi_x^x,x\Incl t\Seq\Delta}{\Gamma,\phi_t^x\Seq\Delta}
\end{center}
\noindent $\phi_t^x$ is the modified formula, $\phi_x^x, x\Incl t$ are side formulae, 
and $t$ is the substituted term.\\
We apply this notions in the top-down fashion, i.e., the formula above the
line will have a side formula, which is modified in the line below.
If one thinks of the bottom-up applications of the rules the notions remain the same but
what was ``modified'' in top-down will now be ``side'' and vice versa.
\end{EXAMPLE}

\noindent
The rules will be tagged by $(\odot_{Xyz})$ according to the following 
convention: 
\begin{itemize}\MyLPar
\item $\odot\in\{=,\Incl\}$ reflects the operator of the active 
formula; 
\item $X\in\{L,R\}$ identifies the side of the inclusion in which 
the modified term occured: $L$ for LHS  or equality and $R$ for RHS;
\item $y\in\{a,s\}$ -- $a$ if the side formula is in the 
antecedent of the sequent, and $s$ if it is in the consequent; the 
rules will be called ``a-rules'', respectively, ``s-rules'';
\item $z$ may be an additional annotation, typically, $x$ if the 
substituted term was a variable, $r$ if the replaced term was a 
variable, $nr$ if the replaced term was not a variable.
\end{itemize}
Thus, for instance, $\iLs$ is the rule with active inclusion which 
modifies a term in either an equality or LHS of an inclusion in the 
succedent.

We will also use following notions for a derivation $D$:
\begin{itemize}\MyLPar
\item the {\em height} of $D$, denoted $h(D)$, with the obvious meaning;
\item the {\em number of applications} of a rule $R$ in $D$, denoted $\#(R,D)$;
%\item the {\em grade of an application} of a rule $R$ in (a branch of) $D$ is
%the consequtive number of this application (in this branch) -- i.e., the first application has
%grade 1, the second 2, and so on;
%\item the {\em grade of a rule} $R$, denoted $gr(R,D)$, is the sum of the grades of all its
%applications in $D$.
\end{itemize}
%
\begin{LEMMA}\label {le:neq1to2}
 $NEQ_1 \Rightarrow NEQ_2^c$.\end{LEMMA}
\begin{PROOF}
%\begin{LS}
%\item 
All specific axioms $\Ax$ are derivable in $NEQ_2$, using ($Sp.cut$) 
rules and derivability of the axiom $s\odot t\Seq s\odot t$ in $NEQ_2$. 

%\item 
The rule ($E_s$) is a restricted version of ($elim1$) when the modified
formula occurs in the succedent.
To see that ($elim1$) is derivable in $NEQ_2$, first observe 
that application of ($elim1$) with the modified 
formula in the succedent yields the same result as application of ($E_s$). 
So, consider an application of ($elim1$) with the modified formula in the 
antecedent. 
\begin{center}
\prule{\Gamma, s(x)\preceq p, x\Incl t\Seq\Delta} 
  {\Gamma, s(t)\preceq p \Seq\Delta}  ($elim1$)
\end{center}
By the restrictions on ($elim1$), $x$ occurs either in $=$ or in a LHS of $\Incl$,
which is indicated by the symbol $\preceq$. We may apply $\iLa$ and 
($elim_s$) to obtain the same conclusion:
\[\begin{array}{cl}
\Gamma, s(x)\preceq p, x\Incl t\Seq\Delta \\ \cline{1-1}
\Gamma, s(t)\preceq p, x\Incl t\Seq\Delta
  & \raisebox{1.2ex}[1.5ex][0ex]{$\iLa$} \\ \cline{1-1}
\Gamma, s(t)\preceq p\Seq\Delta
  & \raisebox{1.2ex}[1.5ex][0ex]{($E_s$)} 
\end{array} \] %\samepage
%\end{LS}       %\samepage
\end{PROOF} 

\begin{CLAIM}\label{le:neq1isneq2}
$NEQ_2^c \equiv NEQ_1$.\end{CLAIM}
\begin{PROOF}
$\Leftarrow$ is lemma~\ref{le:neq1to2}. For the opposite implication we have to 
consider the following situations.
\begin{LS}
\item The ($Sp.cut$) rules \reff{ru:spcut} are derivable in $NEQ_1$.
For each ($Sp.cut_k$), use ($cut$) to its premises and the 
corresponding specific axiom $\Ax_k$.
\item  The rule $\iLa$ is derivable in $NEQ_1$.
Assume that $NEQ_1$ proves the premise 
$s\Incl t, w(s)\preceq q,\GSD$ %$s\Incl t,\Gamma^t_s\Seq\Delta$
 of the rule. (For simplicity, 
consider only the case with one occurrence of $s$ in this premise, i.e., when
it has the form $s\Incl t$.)
The following is a derivation of
the conclusion of the rule in $NEQ_1$:
\[ \begin{array}{rcc}
\raisebox{-1.2ex}[1.5ex][0ex]{(W)} & w(t)\preceq q\Seq w(t)\preceq q &  \\ \cline{2-2}
\raisebox{-1.2ex}[1.5ex][0ex]{
$x$ not in the RHS of $\Incl$ in $\phi$\ \ $\iLs$} %($\Incl_s$)} 
 & s\Incl t,w(t)\preceq q\Seq w(s)\preceq q & 
      \\ \cline{2-2}
 \raisebox{-1.2ex}[1.5ex][0ex]{($cut$)} 
& s\Incl t, w(t)\preceq q\Seq w(s)\preceq q & s\Incl t, w(s)\preceq q,\GSD 
   \\ \cline{2-3}
& \multicolumn{2}{c}{\ \ \ \ \ s\Incl t,w(t)\preceq q,\GSD}
\end{array} \]
\item In a similar way, we show admissibility of $\iRs$ in $NEQ_1$. Assume it
proves the premise of the rule $s\Incl t, \GSD, w\Incl q(s)$. We then construct the 
following derivation of its conclusion in $NEQ_1$:
\[ \begin{array}{rrl}
& x\Incl q(t) \Seq x\Incl q(t) \\ \cline{2-2}
& \Seq q(t)\Incl q(t) & \rabove{(elim1)} \\ \cline{2-2}
& s\Incl t, \Seq q(t)\Incl q(t) & \rabove{(W)} \\ \cline{2-2}
& s\Incl t, \Seq q(s)\Incl q(t) & \rabove{\iLs} \\ \cline{2-2}
& w\Incl q(s), s\Incl t, \Seq q(s)\Incl q(t) & \rabove{(W)} \\ \cline{2-2}
s\Incl t, \GSD, w\Incl q(s) & w\Incl q(s), s\Incl t, \Seq w \Incl q(t) & \rabove{\iLs} \\ \cline{1-2}
\multicolumn{2}{c}{ s\Incl t, \GSD, w\Incl q(t) } & \rabove{(cut)}
\end{array} \]
\end{LS}
\end{PROOF}

\subsection{Calculus $NEQ_3$ -- no weakening rules.}
Applying the standard technique, we will now eliminate the weakening rules by
replacing each axiom of $NEQ_2$ of the form $a\Seq s$ by
the set of axioms $\Gamma,a \Seq\Delta, s$ for all $\Gamma, \Delta$.
This simplifies the proofs,
nevertheless, it is often easier to understand the arguments if
the applications of weakening are made explicit. We will occasionally
formulate the proofs using such an explicit mention of weakening which is to
be understood as starting the whole derivation with another instance of the
same axiom -- in particular, it does not increase the height of the
derivation. More precisely, letting $NEQ_2^*$ denote $NEQ_2$ with axioms 
modified as indicated above and without the weakening rules, we have the following fact:

\begin{LEMMA}\label{le:noweak}
 $\der{NEQ_2}DS\ \impl\ \der{NEQ_2^*}{D^*}S$ and $h(D^*)\leq h(D)$.
\end{LEMMA}
\begin{PROOF}
We have to show that weakening rules are admissible in $NEQ_2^*$. Proceeding
by induction on the number of their applications and $h(D)$, consider the
last rule $R$ applied above weakening. The cases for ($W_a$) and ($W_s$) are
exactly the same, so we only formulate the proof for ($W_a$).
\begin{LS}
\item If no rules are applied above ($W_a$) in $D$, the result is an axiom
 $s\Seq s$ (with LHS possibly empty) of
 $NEQ_2$ weakened by a formula $\phi$. In $NEQ_2^*$ we obtain it directly as
 an axiom $\phi,s \Seq s$. The height of this new derivation is less then $h(D)$.
\item $R$ is ($=$), and $D$ ends as follows
\[ D \left \{ \begin{array}{rl}
 \multicolumn{1}{c}{\vdots} \\
 s=t, f(s)\odot q, \GSD \\ \cline{1-1}
 s=t, f(t)\odot q, \GSD & \rabove{(=)} \\ \cline{1-1}
 \phi, s=t, f(t)\odot q, \GSD & \rabove{(W)} \end{array} \right . \conv
%Obviously, we can swapp the two applications:
 \begin{array}{rl}
 \multicolumn{1}{c}{\vdots} \\
 s=t, f(s)\odot q, \GSD \\ \cline{1-1}
 \phi, s=t, f(s)\odot q, \GSD & \rabove{(W)} \\ \cline{1-1}
 \phi, s=t, f(t)\odot q, \GSD & \rabove{(=)} \end{array} \]
Induction hypothesis on $h(D)$ yields the conclusion.
\item The argument is exactly the same for all the remaining rules, with the
exception of the elimination rules.
\item $R$ is ($E_s$)
\[ D \left \{ \begin{array}{cl}
 D_1 \left \{ \begin{array}{rl}
 \multicolumn{1}{c}{\vdots} \\
 x\Incl t,  \GSD \\ \cline{1-1}
  \GSD_t^x & \rabove{(E_s)} \end{array} \right . \\ \cline{1-1}
 \phi[x], \GSD_t^x & \rabove{(W)} \end{array} \right . \]
If $\phi$ does not contain the eigen-variable $x$ of ($E_s$), we can
trivially swap the two. If it does, however, we have to rename $x$ in the
whole $D_1$ to a new variable, say $y$, not occuring there. We then obtain
equivalent derivation 
\[ D' \left \{ \begin{array}{cl}
 D_1' \left \{ \begin{array}{rl}
 \multicolumn{1}{c}{\vdots} \\
 y\Incl t,  \GSD \\ \cline{1-1}
  \GSD_t^y & \rabove{(E_s)} \end{array} \right . \\ \cline{1-1}
 \phi[x], \GSD_t^y & \rabove{(W)} \end{array} \right . \]
in which we can swap the applications of ($E_s$) and ($W$). \\
\item The same procedure is applied when the last rule was ($E_a$).
\end{LS}
\end{PROOF}

%% \subsection{Calculus $NEQ_3$}
%% In the following we will distinguish between the applications of rules with 
%% the modified formula occurring only in the antecedent or only in the succedent
%% of the conclusion. For instance, ($=_{a}$) will indicate that the application
%% of the rule ($=$) modified only some formulae in the antecedent, and similarly
%% for ($=_{s}$). We used this convention earlier, for instance, 
%% in the rules \reff{ru:Kincl}, \reff{ru:Kincla}
%% indicating by ($\Incl_s\setminus \Incl_a$) that only succedent$\setminus$antecedent
%%  of the premise was modified by the rule. (As before, we are glossing over the 
%% difference between $=_1$ and $=_2$.)

\begin{DEFINITION} Calculus $NEQ_3$ is obtained from $NEQ_2$ by:
\begin{itemize}\MyLPar
\item replacing weakening rules by extended axioms as indicated in lemma \ref{le:noweak};
\item replacing rules \reff{ru:K12} ($=$) by:
\PROOFRULE{s=t,\Gamma\Seq\Delta_t^x}{s=t,\Gamma\Seq\Delta_s^x} ($=_{s}$)
\label{ru:K12s} \ \ \ 
and \ \ \ 
\prule{s=t,\Gamma_t^x\Seq\Delta}{s=t,\Gamma_s^x\Seq\Delta} ($=_{a}$)
\label{ru:K12a} 
\item adding the inference rules of {\em simple cut}
\PROOFRULE{t\Incl t, \Gamma\Seq\Delta}{\Gamma\Seq\Delta} ($cut_t$)\label{ru:sicut}
\ \ \ \ \ \ \ \ \ 
\TABRULE{x=x, \Gamma\Seq\Delta}{\Gamma\Seq\Delta} ($cut_{x=}$)\label{ru:cutxeq}
\end{itemize}
\end{DEFINITION}
\noindent
The rules are shown in figure \ref{fi:neq3}.

\begin{figure}[hbt]
\hspace*{6em}\begin{tabular}{|lcl|}
\hline
\multicolumn{3}{|c|}{{\bf Axioms} :}\\[.5ex]
\multicolumn{3}{|c|}{%$\GSD, t\Incl t$
$x\Incl t,\GSD, x\Incl t$ \ \ \ \ \ \ \ 
$\GSD,x=x$ \ \ \ \ \ \ \
$\Gamma, s= t\Seq s= t, \Delta$ % : $s,t\not\in\Vars$
} \\[2ex]
%
\multicolumn{3}{|c|}{{\bf Identity rules} :}\\[.5ex]
\prule{s=t,\Gamma\Seq\Delta_t^x}{s=t,\Gamma\Seq\Delta_s^x} ($=_{s}$) & &
\prule{s=t,\Gamma_t^x,\Seq\Delta}{s=t,\Gamma_s^x,\Seq\Delta} ($=_{a}$) \\[3ex]
%
\multicolumn{3}{|c|}{{\bf Inclusion rules} :}\\[.5ex]
\prule{s\Incl t, \Gamma\Seq \Delta, w(t)\preceq q}{s\Incl t, \Gamma\Seq
\Delta, w(s)\preceq q} 
$\iLs$ & &
\prule{s\Incl t, w(s)\preceq q,\Gamma\Seq\Delta}{s\Incl t, w(t)\preceq q,\Gamma\Seq\Delta}
 $\iLa$ \\[3ex]
%
\prule{s\Incl t, \GSD, w\Incl q(s)}{s\Incl t, \GSD, w\Incl q(t)} $\iRs$ && \\[3ex]
\multicolumn{3}{|c|}{{\bf Elimination rules} :}\\[.5ex]
\prule{x\Incl t, \Gamma \Seq\Delta} 
  {\Gamma\Seq\Delta_t^x}  ($E_s$) & &
\prule{x\Incl t, y\Incl r(x), \Gamma\Seq\Delta}
  {y\Incl r(t),\Gamma\Seq\Delta}  ($E_a$) \\[1.5ex]
{\footnotesize \ \ \ - $x\not\in \Vars(\Gamma,t)$;} & & 
   {\footnotesize \ \ \ - $x$ is fresh $: x\not\in \C V(t,\Gamma,\Delta)$;} \\
{\footnotesize \ \ \ - at most one $x$ in $\Delta$;} & & 
   {\footnotesize \ \ \ - at most one $x$ in $r$ } \\[2ex]
%
\multicolumn{3}{|c|}{{\bf Simple cut rules} :}\\[.5ex]
\multicolumn{3}{|c|}{\prule{t\Incl t,\Gamma\Seq\Delta}{\Gamma\Seq\Delta}\ ($cut_t$)
\ \ \ \ \ \ \ \ \ 
\prule{x=x, \Gamma\Seq\Delta}{\Gamma\Seq\Delta}\ ($cut_{x=}$) } 
\\[3ex]
%
\multicolumn{3}{|c|}{{\bf Specific cut rules} :}\\[.5ex]
\multicolumn{3}{|c|}
{for each specific axiom $\Ax_k$: \(\lis\atom\Seq \lism\batom{m}\), 
a  rule:}\\[1ex]
\multicolumn{3}{|c|}
{\prule{\Gamma\Seq\Delta,\atom_1\ ;...;\ \Gamma\Seq\Delta,\atom_n\ ;\ 
\batom_1,\Gamma\Seq\Delta\ ;...;\ \batom_m,\Gamma\Seq\Delta} 
{\Gamma\Seq\Delta}\ \ \ ($Sp.cut_k$)} \\[1ex]
\hline
\end{tabular}
\caption{The rules of $NEQ_3$ ($x,y\in\Vars$).}\label{fi:neq3}
\end{figure}

\noindent
Any application of the equality rule \reff{ru:K12} in $NEQ_2$ can be simulated
by repeated applications of the rules \reff{ru:K12s}. % and \reff{ru:K12a}. 
Weakening rules are admissible in $NEQ_3$ according to lemma~\ref{le:noweak} and, in
the presence of the ($cut$) rule, the simple cut ($cut_t$), ($cut_{x=}$) 
do not add anything to the power of the calculus. 
We thus have the obvious:
\begin{CLAIM}\label{le:neq2isneq3}
 $NEQ_2^c \equiv NEQ_3^c$.
\end{CLAIM}